<script type="text/javascript">
dojo.require("dijit.form.Form");
dojo.require("dijit.form.TextBox");
dojo.require("dijit.form.Button");
dojo.require("dijit.Tooltip");

function alreadySelected() {
    cm_all = dojo.byId("e_cm_all");
    cm_sel = dojo.byId("e_cm_sel");
    for( i=0;i<cm_sel.options.length;i++) {
        if(cm_all.options[cm_all.selectedIndex].value == cm_sel.options[i].value ) {
            alert(cm_all.options[cm_all.selectedIndex].innerHTML + " gia' aggiunta");
            return true;
        }
    }
    return false;
}

function onSelComm() {
    cm_all = dojo.byId("e_cm_all");
    cm_sel = dojo.byId("e_cm_sel");
    if(cm_all.selectedIndex > 0 && !alreadySelected()) {
        var oOption = document.createElement('OPTION');
        cm_sel.add(oOption);
        oOption.innerHTML = cm_all.options[cm_all.selectedIndex].innerHTML;
        oOption.value = cm_all.options[cm_all.selectedIndex].value;
    }
}
function onRem() {
    cm_all = dojo.byId("e_cm_all");
    cm_sel = dojo.byId("e_cm_sel");
    if(cm_sel.selectedIndex >= 0) {
        cm_sel.remove(cm_sel.selectedIndex);
    }
}

function removeAll() {
    cm_all = dojo.byId("e_cm_all");
    cm_sel = dojo.byId("e_cm_sel");
    while(cm_sel.options.length) {
        cm_sel.remove(cm_sel.options.length-1);
    }
}
</script>
<style>
#subwrap {width: 64em;}
#content-main {width: 64em;}
</style>
<H1>Registrazione Nuovo Commissario</H1>
<P>
<P>
<span class="ss-required-asterisk">* Campo obbligatorio</span>
<BR>
<FORM dojoType="dijit.form.Form" action="/commissario/registrazione" method="POST" id="form_0">
<script type="dojo/method" event="onSubmit">
cm_sel = dojo.byId("e_cm_sel");
for(var i=0;i<cm_sel.options.length;i++) cm_sel.options[i].selected = true;
if(this.validate()&&
dojo.byId("e_n").value != "" &&
dojo.byId("e_c").value != "" &&
dojo.byId("e_cm_sel").value != ""){
    dojo.byId("e_submit").disabled = true;
    dojo.byId("e_annulla").disabled = true;
    return true;
} else {
    alert('Inserire tutti i dati richiesti');
    return false;
}
</script>
<table width="100%">
<tr>
<td>
<div class="errorbox-good">
<div class="ss-form-entry"><label class="ss-q-title" for="e_n">Nome
<span class="ss-required-asterisk">*</span></label>
<label class="ss-q-help" for="e_n"></label>
<input type="text" dojoType="dijit.form.TextBox" required="true" style="width:20em;" name="nome" value="" class="ss-q-short" id="e_n"></div></div>
</td>
<td>
<div class="errorbox-good">
<div class="ss-form-entry"><label class="ss-q-title" for="e_c">Cognome
<span class="ss-required-asterisk">*</span></label>
<label class="ss-q-help" for="e_c"></label>
<input type="text" dojoType="dijit.form.TextBox" required="true" style="width:20em;" name="cognome" value="" class="ss-q-short" id="e_c"></div></div>
</td>
</tr>
<tr>
<td colspan="2">
<div class="errorbox-good">
<div class="ss-form-entry" id="l_cm"><label class="ss-q-title" for="e_cm">Commissione
<span class="ss-required-asterisk">*</span></label>
<table><tr><td>
<SELECT name="commissione_all" id="e_cm_all" style="width:24em;" onchange="onSelComm();">
<OPTION value="">Selezionare...</OPTION>{% for c in commissioni %}
<OPTION value="{{c.key}}"{% ifequal commissione.key c.key %} selected{% endifequal %}>{{c.nome}} - {{c.tipoScuola}}</OPTION>{% endfor %}
</SELECT><br/><br/>
<!--a class="btn" style="width:120px;" href="javascript:add();">Aggiungi</a>
<a class="btn" style="width:120px;" href="javascript:remove();">Togli selezione</a>
<a class="btn" style="width:120px;" href="javascript:removeAll();">Togli tutti</a><br/><br/><br/-->
<SELECT name="commissione" id="e_cm_sel" multiple="yes" style="width:24em; height:6em;" ondblclick="onRem();">{% for c in commissioni %}
{% ifequal commissione.key c.key %}
<OPTION value="{{c.key}}">{{c.nome}} - {{c.tipoScuola}}</OPTION>
{% endifequal %}
{% endfor %}
</SELECT><span dojoType="dijit.Tooltip" connectId="l_cm" position="above" style="display:none;" id="tt_cm"> 
Aggiungere una o pi&ugrave Commissioni Mensa per cui si desidera registrarsi.<br/><br/>
<ul>
<li>Selezionare una commissione dalla lista per aggiungerla all'elenco, ripetere l'operazione per tutte le Commissioni desiderate</li>
<li>Fare doppio clic su una Commissione per eliminarla dall'elenco in caso di errore</li>
</ul></span> 
</td></tr></table>
</div></div>
</td>
</tr>
<tr>
<td colspan="2">
<h2>Condizioni del Servizio</h2>
L'iscrizione gratuita a Pappa-Mi permette di:
<ul>
<li>Inserire schede di ispezione e segnalazioni di  non conformit&agrave;</li>
<li>Consultare le schede inserite nella propria commmissione</li>
<li>Consultare l'elaborazione statistica dei dati raccolti in tutte le commissioni</li>
</ul>
<p>
Accedendo a "Pappa-Mi" (in seguito "noi", "nostro", "Pappa-Mi"),
l'utente accetta di essere vincolato legalmente alle seguenti
condizioni d'uso. </p>
<p>Se non accetti di essere limitato legalmente alle
condizioni d'uso seguenti non utilizzare i servizi offerti da
"Pappa-Mi".</p>
<p>Le condizioni d'uso possono cambiare in qualunque momento,
sar&agrave; nostra premura avvisarti di tali modifiche, bench&egrave; sia opportuno
controllare con frequenza queste pagine per eventuali modifiche, dato
che l'uso continuato dei servizi di "Pappa-Mi" implica la completa
accettazione delle condizioni d'uso.
</p>
<p>
Pappa-Mi utilizza il sistema Google App Engine (in seguito "Google",
"App Engine software", "code.google.com/appengine/") che &egrave; un software
per la creazione di applicazioni web. Google non &egrave; responsabile dei
contenuti e della gestione. Per ulteriori informazioni su Google App
Engine: http://code.google.com/appengine/.
</p>
<p>
Accetti di non inviare alcun tipo di offesa, oscenit&agrave;, volgarit&agrave;,
calunnia, minaccia, orientamento sessuale, o qualsiasi altro tipo di
materiale che pu&ograve; violare una qualsiasi legge del proprio stato, o
dello stato dove "Pappa-Mi" &egrave; ospitato, o di una legge Internazionale.
Fare ci&ograve; porta all'immediato e permanente divieto di accesso, con
notifica al tuo provider Internet se &egrave; ritenuto da noi opportuno.
</p>
<p>
Accetti che "Pappa-Mi" ha il diritto di rimuovere,
riscrivere, spostare o chiudere qualsiasi argomento in qualsiasi
momento lo ritenga necessario. Come usufruitore di questo servizio,
accetti che ogni informazione tu abbia inviato sia conservata in un
database.</p>
<p>Accetti di rendere accessibile agli altri Commissari iscritti l'indirizzo email utilizzato per accedere a Pappa-Mi. I Commissari potranno utilizzare tale indirizzo per contattarti riguardo l'attivit&agrave; delle Commissioni Mensa di Milano.
</p>
<p>Al contempo queste informazioni non saranno divulgate a
nessun altro senza il tuo consenso, n&egrave; "Pappa-Mi" o Google si ritengono
responsabili per qualsiasi violazione al sistema che possa
compromettere queste informazioni.
</p></td>
</tr>
<tr>
<td align="center" colspan="2">
<button type="submit" id="e_submit">Accetta e invia richiesta</button><button onclick="location.href='/';return false;" id="e_annulla">Annulla</button>
</td>
</tr>
</table></FORM>